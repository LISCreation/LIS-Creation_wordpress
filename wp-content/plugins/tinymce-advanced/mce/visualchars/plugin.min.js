(function(){var a=(function(){var E=function(ao){var ap=ao;var an=function(){return ap};var ar=function(at){ap=at};var aq=function(){return E(an())};return{get:an,set:ar,clone:aq}};var b=tinymce.util.Tools.resolve("tinymce.PluginManager");var af=function(an){var ao=function(){return an.get()};return{isEnabled:ao}};var aj={get:af};var G=function(an,ao){return an.fire("VisualChars",{state:ao})};var F={fireVisualChars:G};var C={"\xA0":"nbsp","\xAD":"shy"};var aa=function(ap,aq){var ao,an="";for(ao in ap){an+=ao}return new RegExp("["+an+"]",aq?"g":"")};var ak=function(ap){var ao,an="";for(ao in ap){if(an){an+=","}an+="span.mce-"+ap[ao]}return an};var c={charMap:C,regExp:aa(C),regExpGlobal:aa(C,true),selector:ak(C),charMapToRegExp:aa,charMapToSelector:ak};var P=function(an){return function(){return an}};var K=P(false);var D=P(true);var d=K;var ab=D;var z=function(){return T};var T=function(){var an=function(av){return av.isNone()};var ap=function(av){return av()};var au=function(av){return av};var ao=function(){};var aq=function(){return null};var ar=function(){return undefined};var at={fold:function(aw,av){return aw()},is:d,isSome:d,isNone:ab,getOr:au,getOrThunk:ap,getOrDie:function(av){throw new Error(av||"error: getOrDie called on none.")},getOrNull:aq,getOrUndefined:ar,or:au,orThunk:ap,map:z,ap:z,each:ao,bind:z,flatten:z,exists:d,forall:ab,filter:z,equals:an,equals_:an,toArray:function(){return[]},toString:P("none()")};if(Object.freeze){Object.freeze(at)}return at}();var U=function(an){var at=function(){return an};var ao=function(){return ap};var aq=function(au){return U(au(an))};var ar=function(au){return au(an)};var ap={fold:function(av,au){return au(an)},is:function(au){return an===au},isSome:ab,isNone:d,getOr:at,getOrThunk:at,getOrDie:at,getOrNull:at,getOrUndefined:at,or:ao,orThunk:ao,map:aq,ap:function(au){return au.fold(z,function(av){return U(av(an))})},each:function(au){au(an)},bind:ar,flatten:at,exists:ar,forall:ar,filter:function(au){return au(an)?ap:T},equals:function(au){return au.is(an)},equals_:function(av,au){return av.fold(d,function(aw){return au(an,aw)})},toArray:function(){return[an]},toString:function(){return"some("+an+")"}};return ap};var t=function(an){return an===null||an===undefined?T:U(an)};var n={some:U,none:z,from:t};var k=function(an){if(an===null){return"null"}var ao=typeof an;if(ao==="object"&&Array.prototype.isPrototypeOf(an)){return"array"}if(ao==="object"&&String.prototype.isPrototypeOf(an)){return"string"}return ao};var O=function(an){return function(ao){return k(ao)===an}};var x=O("function");var M=function(ap,at){var ao=ap.length;var ar=new Array(ao);for(var aq=0;aq<ao;aq++){var an=ap[aq];ar[aq]=at(an,aq,ap)}return ar};var ac=function(ap,ar){for(var aq=0,ao=ap.length;aq<ao;aq++){var an=ap[aq];ar(an,aq,ap)}};var w=Array.prototype.slice;var h=x(Array.from)?Array.from:function(an){return w.call(an)};var j=function(an,ao){var ap=ao||document;var aq=ap.createElement("div");aq.innerHTML=an;if(!aq.hasChildNodes()||aq.childNodes.length>1){console.error("HTML does not have a single root node",an);throw"HTML must have a single root node"}return o(aq.childNodes[0])};var al=function(an,ao){var aq=ao||document;var ap=aq.createElement(an);return o(ap)};var i=function(aq,an){var ap=an||document;var ao=ap.createTextNode(aq);return o(ao)};var o=function(an){if(an===null||an===undefined){throw new Error("Node cannot be null or undefined")}return{dom:P(an)}};var u=function(ao,an,aq){var ap=ao.dom();return n.from(ap.elementFromPoint(an,aq)).map(o)};var V={fromHtml:j,fromTag:al,fromText:i,fromDom:o,fromPoint:u};var Y={ATTRIBUTE:Node.ATTRIBUTE_NODE,CDATA_SECTION:Node.CDATA_SECTION_NODE,COMMENT:Node.COMMENT_NODE,DOCUMENT:Node.DOCUMENT_NODE,DOCUMENT_TYPE:Node.DOCUMENT_TYPE_NODE,DOCUMENT_FRAGMENT:Node.DOCUMENT_FRAGMENT_NODE,ELEMENT:Node.ELEMENT_NODE,TEXT:Node.TEXT_NODE,PROCESSING_INSTRUCTION:Node.PROCESSING_INSTRUCTION_NODE,ENTITY_REFERENCE:Node.ENTITY_REFERENCE_NODE,ENTITY:Node.ENTITY_NODE,NOTATION:Node.NOTATION_NODE};var r=function(an){var ao=an.dom().nodeName;return ao.toLowerCase()};var am=function(an){return an.dom().nodeType};var X=function(an){return an.dom().nodeValue};var W=function(an){return function(ao){return am(ao)===an}};var s=function(an){return am(an)===Y.COMMENT||r(an)==="#comment"};var ag=W(Y.ELEMENT);var g=W(Y.TEXT);var B=W(Y.DOCUMENT);var L={name:r,type:am,value:X,isElement:ag,isText:g,isDocument:B,isComment:s};var v=function(an){return'<span data-mce-bogus="1" class="mce-'+c.charMap[an]+'">'+an+"</span>"};var ai={wrapCharWithSpan:v};var H=function(an){return L.isText(an)&&L.value(an)!==undefined&&c.regExp.test(L.value(an))};var q=function(aq,ao){var an=[];var ar=aq.dom();var ap=M(ar.childNodes,V.fromDom);ac(ap,function(at){if(ao(at)){an=an.concat([at])}an=an.concat(q(at,ao))});return an};var e=function(ao,an){while(ao.parentNode){if(ao.parentNode===an){return ao}ao=ao.parentNode}};var y=function(an){return an.replace(c.regExpGlobal,ai.wrapCharWithSpan)};var p={isMatch:H,filterDescendants:q,findParentElm:e,replaceWithSpans:y};var S=function(ao,aq){var ap,ar;var an=p.filterDescendants(V.fromDom(aq),p.isMatch);ac(an,function(au){var at=p.replaceWithSpans(L.value(au));ar=ao.dom.create("div",null,at);while(ap=ar.lastChild){ao.dom.insertAfter(ap,au.dom())}ao.dom.remove(au.dom())})};var ae=function(ap,an){var ao=ap.dom.select(c.selector,an);ac(ao,function(aq){ap.dom.remove(aq,1)})};var J=function(aq){var ao=aq.getBody();var ap=aq.selection.getBookmark();var an=p.findParentElm(aq.selection.getNode(),ao);an=an!==undefined?an:ao;ae(aq,an);S(aq,an);aq.selection.moveToBookmark(ap)};var Z={show:S,hide:ae,toggle:J};var N=function(ar,ao){var an=ar.getBody();var aq=ar.selection;var ap;ao.set(!ao.get());F.fireVisualChars(ar,ao.get());ap=aq.getBookmark();if(ao.get()===true){Z.show(ar,an)}else{Z.hide(ar,an)}aq.moveToBookmark(ap)};var I={toggleVisualChars:N};var m=function(ao,an){ao.addCommand("mceVisualChars",function(){I.toggleVisualChars(ao,an)})};var ah={register:m};var ad=tinymce.util.Tools.resolve("tinymce.util.Delay");var l=function(ao,an){var ap=ad.debounce(function(){Z.toggle(ao)},300);if(ao.settings.forced_root_block!==false){ao.on("keydown",function(aq){if(an.get()===true){aq.keyCode===13?Z.toggle(ao):ap()}})}};var Q={setup:l};var f=function(an){return function(ap){var ao=ap.control;an.on("VisualChars",function(aq){ao.active(aq.state)})}};var R=function(an){an.addButton("visualchars",{active:false,title:"Show invisible characters",cmd:"mceVisualChars",onPostRender:f(an)});an.addMenuItem("visualchars",{text:"Show invisible characters",cmd:"mceVisualChars",onPostRender:f(an),selectable:true,context:"view",prependToContext:true})};b.add("visualchars",function(ao){var an=E(false);ah.register(ao,an);R(ao);Q.setup(ao,an);return aj.get(an)});function A(){}return A}())})();