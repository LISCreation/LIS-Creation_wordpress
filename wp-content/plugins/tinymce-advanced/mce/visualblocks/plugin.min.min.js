(function(){var b=(function(){var L=function(g){var e=g;var d=function(){return e};var f=function(h){e=h};var c=function(){return L(d())};return{get:d,set:f,clone:c}};var z=tinymce.util.Tools.resolve("tinymce.PluginManager");var N=function(c,d){c.fire("VisualBlocks",{state:d})};var F={fireVisualBlocks:N};var A=function(c){return c.getParam("visualblocks_default_state",false)};var K=function(c){return c.settings.visualblocks_content_css};var a={isEnabledByDefault:A,getContentCss:K};var G=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils");var H=tinymce.util.Tools.resolve("tinymce.util.Tools");var E=G.DOM.uniqueId();var J=function(e,d){var g=H.toArray(e.getElementsByTagName("link"));var f=H.grep(g,function(h){return h.id===E});if(f.length===0){var c=G.DOM.create("link",{id:E,rel:"stylesheet",href:d});e.getElementsByTagName("head")[0].appendChild(c)}};var D={load:J};var P=function(g,d,e){var c=g.dom;var f=a.getContentCss(g);D.load(g.getDoc(),f?f:d+"/css/visualblocks.css");c.toggleClass(g.getBody(),"mce-visualblocks");e.set(!e.get());F.fireVisualBlocks(g,e.get())};var y={toggleVisualBlocks:P};var Q=function(e,c,d){e.addCommand("mceVisualBlocks",function(){y.toggleVisualBlocks(e,c,d)})};var I={register:Q};var C=function(e,c,d){e.on("PreviewFormats AfterPreviewFormats",function(f){if(d.get()){e.dom.toggleClass(e.getBody(),"mce-visualblocks",f.type==="afterpreviewformats")}});e.on("init",function(){if(a.isEnabledByDefault(e)){y.toggleVisualBlocks(e,c,d)}});e.on("remove",function(){e.dom.removeClass(e.getBody(),"mce-visualblocks")})};var M={setup:C};var B=function(c,d){return function(e){var f=e.control;f.active(d.get());c.on("VisualBlocks",function(g){f.active(g.state)})}};var x=function(c,d){c.addButton("visualblocks",{active:false,title:"Show blocks",cmd:"mceVisualBlocks",onPostRender:B(c,d)});c.addMenuItem("visualblocks",{text:"Show blocks",cmd:"mceVisualBlocks",onPostRender:B(c,d),selectable:true,context:"view",prependToContext:true})};var R={register:x};z.add("visualblocks",function(e,c){var d=L(false);I.register(e,c,d);R.register(e,d);M.setup(e,c,d)});function O(){}return O}())})();