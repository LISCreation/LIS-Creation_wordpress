(function(){var a=(function(){var d=tinymce.util.Tools.resolve("tinymce.PluginManager");var h=function(s){return/^[A-Za-z][A-Za-z0-9\-:._]*$/.test(s)};var e=function(t){var u=t.selection.getNode();var s=u.tagName==="A"&&t.dom.getAttrib(u,"href")==="";return s?u.id||u.name:""};var q=function(t,v){var u=t.selection.getNode();var s=u.tagName==="A"&&t.dom.getAttrib(u,"href")==="";if(s){u.removeAttribute("name");u.id=v;t.undoManager.add()}else{t.focus();t.selection.collapse(true);t.execCommand("mceInsertContent",false,t.dom.createHTML("a",{id:v}))}};var i={isValidId:h,getId:e,insert:q};var f=function(t,s){if(!i.isValidId(s)){t.windowManager.alert("Id should start with a letter, followed only by letters, numbers, dashes, dots, colons or underscores.");return true}else{i.insert(t,s);return false}};var k=function(t){var s=i.getId(t);t.windowManager.open({title:"Anchor",body:{type:"textbox",name:"id",size:40,label:"Id",value:s},onsubmit:function(v){var u=v.data.id;if(f(t,u)){v.preventDefault()}}})};var j={open:k};var p=function(s){s.addCommand("mceAnchor",function(){j.open(s)})};var r={register:p};var m=function(s){return !s.attr("href")&&(s.attr("id")||s.attr("name"))&&!s.firstChild};var n=function(s){return function(t){for(var u=0;u<t.length;u++){if(m(t[u])){t[u].attr("contenteditable",s)}}}};var g=function(s){s.on("PreInit",function(){s.parser.addNodeFilter("a",n("false"));s.serializer.addNodeFilter("a",n(null))})};var b={setup:g};var c=function(s){s.addButton("anchor",{icon:"anchor",tooltip:"Anchor",cmd:"mceAnchor",stateSelector:"a:not([href])"});s.addMenuItem("anchor",{icon:"anchor",text:"Anchor",context:"insert",cmd:"mceAnchor"})};var l={register:c};d.add("anchor",function(s){b.setup(s);r.register(s);l.register(s)});function o(){}return o}())})();